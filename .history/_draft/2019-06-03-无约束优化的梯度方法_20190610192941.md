---
layout:     post
title:      含约束优化的梯度方法
subtitle:   Gradient Methods for Constrained Problems
date:       2019-06-09
author:     shellyyz
# description: some common commands in Git.
# header-img: img/post-bg-ios9-web.jpg -->
catalog: 	 true
comments: true
tags:
    - 凸优化
    - 优化方法
---
{% include head.html %}
# 含约束优化的梯度方法

[TOC]

*本文主要参照Princeton Prof. Yunxin Chen的Slides以及课堂笔记做的总结，前面说了无约束问题的梯度优化方法，现在聊一下含约束条件的情况。*

讨论对象：
$$
\begin{array}{ll}{\operatorname{minimize}_{\boldsymbol{x}}} & {f(\boldsymbol{x})} \\ {\text { subject to }} & {\boldsymbol{x} \in \mathcal{C}}\end{array}
$$
其中 $f$ 是凸函数，$\mathcal{C} \subseteq \mathbb{R}^{n}$ 是闭合 closed 凸集。

几个基本概念：
* 可行方向 feasible direction： 对于 $x^t\in \mathcal{C}$, 如果 $d^t$ 使得 $\boldsymbol{x}^{t+1}=\boldsymbol{x}^{t}+\eta_{t} \boldsymbol{d}^{t}\in \mathcal{C}$,则称 $d^t$ 是可行方向。
* 可行方向方法 Feasible direction methods: 通过迭代 $\boldsymbol{x}^{t+1}=\boldsymbol{x}^{t}+\eta_{t} \boldsymbol{d}^{t}$ 构造可行序列 $\left\{x^{t}\right\} \subseteq \mathcal{C}$， 其中 $d^t$ 是可行方向。

但优化是希望目标函数值减少，能在保证可行性 feasibility 的情况下同时使目标函数值下降吗？

## Frank-Wolfe algorithm

<img src="https://i.loli.net/2019/06/10/5cfe0ced72c6443564.png" alt="FW_algo.png" title="FW-algo" div align=center />

* FW 算法每次迭代时包含两步，第一步找到合适的下降方向，第二步根据步长更新。
* 第一步直觉上要更难也更关键。它本质等价于另一个优化问题：
$$
\boldsymbol{y}^{t} :=\arg \min _{\boldsymbol{x} \in \mathcal{C}}\left\langle\nabla f\left(\boldsymbol{x}^{t}\right), \boldsymbol{x}\right\rangle = \arg \min _{\boldsymbol{x} \in \mathcal{C}}f\left(\boldsymbol{x}^{t}\right)+\left\langle\nabla f\left(\boldsymbol{x}^{t}\right), \boldsymbol{x}-\boldsymbol{x}^{t}\right\rangle )
$$
是凸集上的线性函数优化（对比想一下凸集上的凸函数优化），当线性优化的代价小时还是很不错的。
* 第二步的步长可以用 line search 确定，或者采用 $\eta_{t}=\frac{2}{t+2}$，后者当迭代次数 t 增大时，更新会更偏向 $x^t$ 而不是 $y^t$。 

下面着重讨论一下在 atomic sets 上的优化。
* 度规函数 Gauge function: 对于向量空间 $X$ 中任意 compact 且 convex 的子集 $D$， 该凸集 $D$ 的Gauge function 定义为 
$$
\Lambda_D(x):=\inf_{t} \{ t | x\in tD\}
$$
* 支持函数 support function: 该凸集 $D$ 的支持函数定义为
$$
\Lambda_{D}^*(y):=\sup_{s\in D} \langle s, y\rangle
$$

举例：核范数 nuclear norm
$D:= \operatorname{conv}\left( \{ uv^{\top}|u\in \mathbb{R}^n, \| u\|_2=1,v\in \mathbb{R}^n, \| v\|_2=1 \}\right)$ 实际是核范数不大于1的 $n\times n$ 矩阵的集合, 该集合的 gauge function 为 $\Lambda_D(M)=\inf_{t}\{t|M\in tD\} = \| M\|_*=\sum_{i=1}^{n}\sigma_i(M)$ .

**Fact**: 由 convex hull 的定义可得，任意一个线性函数在 convex hull 的最大值在一个向量上取到。 $\Lambda_D^*(x)=\Lambda_{\operatorname{conv}(A)}^{*}(x)=\sup_{s\in \operatorname{conv}(A)}\langle s,x \rangle =\sup_{s\in A}\langle s,x \rangle$